# 10 - 1 字符串、数组和指针

## 01 字符串字面量（字符串常量）
用双引号括起来的内容称为**字符串字面量**，也叫做**字符串常量**。双引号中的字符和**编译器自动加入末尾的\0**字符，都作为字符串存储在内存中。

从ANSI C(**C89**)标准起，如果字符串字面量之间没有间隔，或者用空白字符间隔，C会将其视为串联起来的字符串字面量。例如：
```c
char greeting[40]="Xiaomi ""Hyper" "OS";
char greeting[40]="Xiaomi HyperOS";
```
这两条声明等价。

**用双引号括起来的内容被视为指向该字符串存储位置的指针**，这类似于数组名为指向该数组首元素的指针。
```c
printf("%s, %p, %c, %c", "We", "Are", *"XMUer", "XMUer");
```
输出：``We, 0000000000404000, X,``
>[!important]
用双引号括起来的字符串实际上是**字符串地址**，而%c转换说明需要的是**字符型参数**，与字符串地址类型不匹配，因此没有合法的字符输出。

## 02 创建字符串
### （1）使用字符数组
在[字符数组](/1-笔记/07%20-%20数组/07%20-%203%20字符数组.md)一节中已提到。
### （2）使用指针
```c
const char * str = "Xiaomi HyperOS";
const char ar1[] = "Xiaomi HyperOS";
```
此时两种声明都表明，``pt1``和``ar1``都是指向字符串``"Xiaomi HyperOS"``的指针。

### （3）使用数组和指针创建字符串的不同点
+ 使用数组，字符串有**两个副本**，一个是**静态内存中的字符串字面量**，另一个是**存储在数组中的字符串**。而使用指针，字符串只有**静态内存中的字符串字面量**。
+ 使用数组，数组名是**地址常量**，不能更改数组名，也不能递增。使用指针，则指针变量可以递增等（未const）。
+ 使用数组，为**字符串字面量**和**字符数组**分配空间。使用指针，为**字符串字面量**和**指针变量**分配空间。

因此，打算修改字符串，最好不要使用指针，因为会破坏字符串。

```c
#define MSG "I'm special."
#include <stdio.h>
int main()
{
    char ar[] = MSG;
    const char *pt = MSG;
    printf("address of \"I'm special\": %p \n", "I'm special");
    printf("              address ar: %p\n", ar);
    printf("              address pt: %p\n", pt);
    printf("          address of MSG: %p\n", MSG);
    printf("address of \"I'm special\": %p \n", "I'm special");

    return 0;
}
```
最终输出：
```
address of "I'm special": 000000000040400D
              address ar: 000000000062FE30
              address pt: 0000000000404000
          address of MSG: 0000000000404000
address of "I'm special": 000000000040400D
```
+ pt 和 ar 指向的地址不同。因为pt指向的是字符串字面量，而ar指向的是字符串在数组中的副本。
+ **编译器**会给**相同的字符串**分配**相同的地址**。也可分配到多处，这取决于编译器。
